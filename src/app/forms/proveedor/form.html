<div class="card shadow-sm">
  <div class="card-body">
    <h2 class="h5 mb-3">Gesti√≥n de Proveedores</h2>

    <!-- FORMULARIO -->
    <form (ngSubmit)="save()">
      <div class="row">
        <!-- ID solo lectura -->
        <div class="col-md-4 mb-2">
          <label class="form-label">ID</label>
          <input class="form-control" type="number" [(ngModel)]="editingId" name="id" readonly>
        </div>

        <div class="col-md-4 mb-2">
          <label class="form-label">Nombre</label>
          <input class="form-control" type="text" [(ngModel)]="model.nombre" name="nombre" required>
        </div>

        <div class="col-md-4 mb-2">
          <label class="form-label">Empresa</label>
          <input class="form-control" type="text" [(ngModel)]="model.empresa" name="empresa">
        </div>

        <div class="col-md-4 mb-2">
          <label class="form-label">Email</label>
          <input class="form-control" type="email" [(ngModel)]="model.email" name="email">
        </div>

        <div class="col-md-4 mb-2">
          <label class="form-label">Tel√©fono</label>
          <input class="form-control" type="text" [(ngModel)]="model.telefono" name="telefono">
        </div>

        <div class="col-md-4 mb-2">
          <label class="form-label">Direcci√≥n</label>
          <input class="form-control" type="text" [(ngModel)]="model.direccion" name="direccion">
        </div>

        <div class="col-md-6 mb-2">
          <label class="form-label">Descripci√≥n</label>
          <input class="form-control" type="text" [(ngModel)]="model.descripcion" name="descripcion">
        </div>

        <div class="col-md-6 mb-2">
          <label class="form-label">Estado</label>
          <select class="form-select" [(ngModel)]="model.estado" name="estado" required>
            <option [ngValue]="1">Activo</option>
            <option [ngValue]="0">Inactivo</option>
          </select>
        </div>
      </div>

      <div class="mt-3">
        <button class="btn btn-primary me-2" type="submit" [disabled]="loading">
          {{ editingId ? 'Actualizar' : 'Guardar' }}
        </button>
        <button class="btn btn-secondary" type="button" (click)="reset()">Nuevo</button>
      </div>

      <div *ngIf="error" class="alert alert-danger mt-3">{{ error }}</div>
    </form>

    <hr>

    <!-- LISTADO -->
    <div *ngIf="loading" class="text-muted">Cargando‚Ä¶</div>

    <div class="table-responsive" *ngIf="!loading && items?.length">
      <table class="table table-sm table-striped align-middle">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Empresa</th>
            <th>Email</th>
            <th>Tel√©fono</th>
            <th>Direcci√≥n</th>
            <th>Descripci√≥n</th>
            <th>Estado</th>
            <th style="width:120px">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of items">
            <td>{{ r.id ?? r.id_proveedor }}</td>
            <td>{{ r.nombre }}</td>
            <td>{{ r.empresa }}</td>
            <td>{{ r.email }}</td>
            <td>{{ r.telefono }}</td>
            <td>{{ r.direccion }}</td>
            <td>{{ r.descripcion }}</td>
            <td>
              <span class="badge" [ngClass]="r.estado === 1 ? 'bg-success' : 'bg-secondary'">
                {{ r.estado === 1 ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
            <td>
              <button class="btn btn-sm btn-outline-primary me-1" (click)="edit(r)" type="button">
                ‚úèÔ∏è
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="confirmRemove(r.id ?? r.id_proveedor)" type="button">
                üóëÔ∏è
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="!loading && !items?.length" class="text-muted text-center py-3">
      No hay proveedores registrados.
    </div>
  </div>
</div>

<!-- MODAL DE CONFIRMACI√ìN -->
<div class="modal fade" [class.show]="showDeleteModal" [style.display]="showDeleteModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Confirmar eliminaci√≥n</h5>
        <button type="button" class="btn-close" (click)="cancelRemove()"></button>
      </div>
      <div class="modal-body">
        <p>¬øSeguro que deseas eliminar este proveedor?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="cancelRemove()">Cancelar</button>
        <button type="button" class="btn btn-danger" (click)="remove()">Eliminar</button>
      </div>
    </div>
  </div>
</div>
